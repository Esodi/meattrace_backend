{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shop QR Codes - {{ shop_name }}</title>
    <link rel="stylesheet" href="{% static 'meat_trace/css/print.css' %}">
    <style>
        /* Keep size/layout conditionals inline */
        .qr-code img {
            width: {% if size == 'small' %}100px{% elif size == 'medium' %}120px{% else %}150px{% endif %};
            height: {% if size == 'small' %}100px{% elif size == 'medium' %}120px{% else %}150px{% endif %};
        }

        {% if layout == 'single' %}
        .products-grid { grid-template-columns:1fr }
        .product-card { max-width:600px; margin:0 auto 20px }
        .qr-code img { width: {% if size == 'small' %}150px{% elif size == 'medium' %}200px{% else %}250px{% endif %}; height: {% if size == 'small' %}150px{% elif size == 'medium' %}200px{% else %}250px{% endif %}; }
        .product-info h3 { font-size:18px }
        .info-grid { font-size:14px }
        {% endif %}
    </style>
</head>
<body>
    <div class="header">
        <h1>Meat Trace QR Codes</h1>
        <p>Shop: {{ shop_name }}</p>
        <p>Printed by: {{ printed_by }} | Printed at: {{ printed_at|date:"M d, Y H:i" }}</p>
    </div>

    <div class="products-grid">
        {% for product in products %}
        <div class="product-card">
            <div class="qr-section">
                <div class="qr-code">
                    {% if product.qr_code %}
                    <img src="/media/{{ product.qr_code }}" alt="QR Code for {{ product.name }}">
                    {% else %}
                    <div style="width: 120px; height: 120px; border: 2px solid #ccc; display: flex; align-items: center; justify-content: center; background: #f5f5f5;">
                        <span style="color: #999; font-size: 10px;">QR Code<br>Not Available</span>
                    </div>
                    {% endif %}
                </div>

                <div class="product-info">
                    <h3>{{ product.name }}</h3>
                    <div class="info-grid">
                        <span class="info-label">Batch:</span>
                        <span class="info-value">{{ product.batch_number }}</span>

                        <span class="info-label">Type:</span>
                        <span class="info-value">{{ product.product_type|title }}</span>

                        <span class="info-label">Quantity:</span>
                        <span class="info-value">{{ product.quantity }} {{ product.weight_unit }}</span>

                        {% if product.weight %}
                        <span class="info-label">Weight:</span>
                        <span class="info-value">{{ product.weight }} {{ product.weight_unit }}</span>
                        {% endif %}

                        {% if product.animal %}
                        <span class="info-label">Animal ID:</span>
                        <span class="info-value">{{ product.animal.animal_id }}</span>
                        {% endif %}

                        {% if product.processing_unit %}
                        <span class="info-label">Processor:</span>
                        <span class="info-value">{{ product.processing_unit.username }}</span>
                        {% endif %}

                        <span class="info-label">Received:</span>
                        <span class="info-value">{{ product.received_at|date:"M d, Y" }}</span>
                    </div>

                    <div class="shop-stamp">
                        Verified by {{ shop_name }}<br>
                        Product ID: {{ product.id }}
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>

    <div class="footer">
        <p>Scan QR codes to view complete product traceability information</p>
        <p>These products have been received and verified by {{ shop_name }}</p>
        <p>Total products: {{ products|length }}</p>
    </div>
</body>
</html>